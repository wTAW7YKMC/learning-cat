(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[728],{3432:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cards",function(){return a(6822)}])},6822:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var r=a(5893),l=a(7294),s=a(1649),c=a(2121),i=a(7066),n=a(8387);let o=(0,n.Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);var d=a(113);let x=(0,n.Z)("Gift",[["polyline",{points:"20 12 20 22 4 22 4 12",key:"nda8fc"}],["rect",{width:"20",height:"5",x:"2",y:"7",key:"wkgdzj"}],["line",{x1:"12",x2:"12",y1:"22",y2:"7",key:"1n8zgp"}],["path",{d:"M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z",key:"zighg4"}],["path",{d:"M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z",key:"1pa5tk"}]]);var m=a(2279);let p=(0,n.Z)("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),h=(0,n.Z)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),u={common:"border-gray-300 bg-white",rare:"border-blue-500 bg-blue-50",epic:"border-purple-500 bg-purple-50",legendary:"border-yellow-500 bg-yellow-50"},y={common:"from-gray-400 to-gray-600",rare:"from-blue-400 to-blue-600",epic:"from-purple-400 to-purple-600",legendary:"from-yellow-400 to-yellow-600"},g={common:null,rare:(0,r.jsx)(o,{className:"w-4 h-4 text-blue-500"}),epic:(0,r.jsx)(p,{className:"w-4 h-4 text-purple-500"}),legendary:(0,r.jsx)(h,{className:"w-4 h-4 text-yellow-500"})},j=e=>{let{card:t,isGallery:a=!1,onEquip:s,isEquipped:c}=e,[i,n]=(0,l.useState)(!1);return a&&!t.collected?(0,r.jsxs)("div",{className:"aspect-[3/4] bg-gray-100 rounded-lg border-2 border-dashed border-gray-300 flex flex-col items-center justify-center p-4",children:[(0,r.jsx)("div",{className:"text-gray-400 mb-2",children:(0,r.jsx)("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),(0,r.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"未收集"})]}):(0,r.jsxs)("div",{className:"relative group cursor-pointer transition-all duration-200 hover:scale-105 hover:shadow-xl",onClick:()=>n(!0),children:[(0,r.jsxs)("div",{className:"aspect-[3/4] rounded-lg border-2 ".concat(u[t.rarity]," p-4 flex flex-col items-center justify-center text-center relative overflow-hidden"),children:["common"!==t.rarity&&(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br ".concat(y[t.rarity]," opacity-10 rounded-lg animate-pulse")}),(0,r.jsx)("div",{className:"w-16 h-16 mb-3 relative z-10",children:t.image_url?(0,r.jsx)("img",{src:t.image_url,alt:t.name,className:"w-full h-full rounded-lg object-cover"}):(0,r.jsx)("div",{className:"w-full h-full rounded-lg bg-gradient-to-br ".concat(y[t.rarity]," flex items-center justify-center"),children:(0,r.jsx)(m.Z,{className:"w-6 h-6 text-white"})})}),(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-800 mb-1 relative z-10",children:t.name}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:t.character_name}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 relative z-10",children:[g[t.rarity],(0,r.jsx)("span",{className:"text-xs font-medium ".concat("common"===t.rarity?"text-gray-600":"rare"===t.rarity?"text-blue-600":"epic"===t.rarity?"text-purple-600":"text-yellow-600"),children:"common"===t.rarity?"普通":"rare"===t.rarity?"稀有":"epic"===t.rarity?"史诗":"传说"})]}),c&&(0,r.jsx)("div",{className:"absolute top-2 right-2 bg-green-500 text-white rounded-full p-1",children:(0,r.jsx)("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),i&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>n(!1),children:(0,r.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-sm w-full",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:t.name}),(0,r.jsx)("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[g[t.rarity],(0,r.jsxs)("span",{className:"text-sm font-medium ".concat("common"===t.rarity?"text-gray-600":"rare"===t.rarity?"text-blue-600":"epic"===t.rarity?"text-purple-600":"text-yellow-600"),children:["common"===t.rarity?"普通":"rare"===t.rarity?"稀有":"epic"===t.rarity?"史诗":"传说","卡片"]})]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"角色:"})," ",t.character_name]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"主题:"})," ",t.theme]}),t.subject&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"学科:"})," ",t.subject]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"获得时间:"})," ",new Date(t.obtain_time).toLocaleDateString()]}),t.description&&(0,r.jsx)("p",{className:"pt-2",children:t.description})]}),!a&&(0,r.jsx)("div",{className:"mt-6 flex space-x-3",children:(0,r.jsx)("button",{onClick:()=>s(t.card_id),disabled:c,className:"flex-1 py-2 px-4 rounded-lg font-medium transition-colors ".concat(c?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700"),children:c?"已装备":"装备为背景"})})]})})]})};function b(){let[e,t]=(0,l.useState)("collection"),[a,n]=(0,l.useState)({rarity:"all",theme:"all"}),[o,m]=(0,l.useState)(!1),p=(0,s.I0)(),{collection:h,gallery:u}=(0,s.v9)(e=>e.cards),y=async()=>{m(!0);try{let t=localStorage.getItem("token"),r="collection"===e?"/collection":"/gallery",l=await i.Z.get("".concat("http://localhost:3001","/api/cards").concat(r),{params:a,headers:{Authorization:"Bearer ".concat(t)}});if(l.data.success){let t="collection"===e?c.dp:c.od;p(t("collection"===l.data.data.activeTab?l.data.data.collection:l.data.data.gallery))}}catch(e){console.error("获取卡片数据失败:",e)}finally{m(!1)}};(0,l.useEffect)(()=>{y()},[e,a]);let g=async e=>{try{let t=localStorage.getItem("token"),a=await i.Z.post("".concat("http://localhost:3001","/api/cards/equip/").concat(e),{},{headers:{Authorization:"Bearer ".concat(t)}});a.data.success&&(p((0,c.HG)(e)),alert("卡片装备成功！"))}catch(e){console.error("装备卡片失败:",e)}},b="collection"===e?h:u;return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50",children:[(0,r.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{className:"flex justify-between items-center h-16",children:(0,r.jsx)("h1",{className:"text-2xl font-bold text-gradient",children:"卡片图鉴"})})})}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"flex space-x-1 mb-6",children:[(0,r.jsx)("button",{onClick:()=>t("collection"),className:"px-6 py-3 font-medium rounded-t-lg transition-colors ".concat("collection"===e?"bg-white text-purple-600 border-b-2 border-purple-600":"bg-gray-100 text-gray-600 hover:text-gray-900"),children:"我的收藏"}),(0,r.jsx)("button",{onClick:()=>t("gallery"),className:"px-6 py-3 font-medium rounded-t-lg transition-colors ".concat("gallery"===e?"bg-white text-purple-600 border-b-2 border-purple-600":"bg-gray-100 text-gray-600 hover:text-gray-900"),children:"全部图鉴"})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(d.Z,{className:"w-5 h-5 text-gray-500"}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsxs)("select",{value:a.rarity,onChange:e=>n({...a,rarity:e.target.value}),className:"input text-sm",children:[(0,r.jsx)("option",{value:"all",children:"所有稀有度"}),(0,r.jsx)("option",{value:"common",children:"普通"}),(0,r.jsx)("option",{value:"rare",children:"稀有"}),(0,r.jsx)("option",{value:"epic",children:"史诗"}),(0,r.jsx)("option",{value:"legendary",children:"传说"})]}),(0,r.jsxs)("select",{value:a.theme,onChange:e=>n({...a,theme:e.target.value}),className:"input text-sm",children:[(0,r.jsx)("option",{value:"all",children:"所有主题"}),(0,r.jsx)("option",{value:"学习",children:"学习"}),(0,r.jsx)("option",{value:"热血",children:"热血"}),(0,r.jsx)("option",{value:"治愈",children:"治愈"}),(0,r.jsx)("option",{value:"校园",children:"校园"})]})]})]})}),o?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-8 h-8 border-2 border-purple-600 border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("p",{className:"mt-2 text-gray-500",children:"加载中..."})]}):b.length>0?(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:b.map(t=>(0,r.jsx)(j,{card:t,isGallery:"gallery"===e,onEquip:g,isEquipped:t.is_equipped},t.card_id))}):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"text-gray-400 mb-4",children:(0,r.jsx)(x,{className:"w-12 h-12 mx-auto"})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"collection"===e?"还没有收集到卡片":"图鉴暂无内容"}),(0,r.jsx)("p",{className:"text-gray-500",children:"collection"===e?"完成任务即可获得卡片奖励！":"卡片图鉴正在准备中..."})]})]})]})}b.requireAuth=!0},113:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var r=a(8387);let l=(0,r.Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},2279:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var r=a(8387);let l=(0,r.Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]])}},function(e){e.O(0,[512,774,888,179],function(){return e(e.s=3432)}),_N_E=e.O()}]);